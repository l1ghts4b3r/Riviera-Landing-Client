/*!
 * pagepiling.js 1.5.6
 *
 * https://github.com/alvarotrigo/pagePiling.js
 * @license MIT licensed
 *
 * Copyright (C) 2016 alvarotrigo.com - A project by Alvaro Trigo
 */ !function(e,n,t,o){"use strict";e.fn.pagepiling=function(i){function a(n,t){var o,i,a,p,v,h,u,f,m,g={destination:n,animated:t,activeSection:e(".pp-section.active"),anchorLink:n.data("anchor"),sectionIndex:n.index(".pp-section"),toMove:n,yMovement:(f=n,(m=e(".pp-section.active").index(".pp-section"))>f.index(".pp-section")?"up":"down"),leavingSection:e(".pp-section.active").index(".pp-section")+1};if(!g.activeSection.is(n)){void 0===g.animated&&(g.animated=!0),void 0!==g.anchorLink&&(o=g.anchorLink,i=g.sectionIndex,I.anchors.length?(location.hash=o,l(location.hash)):l(String(i))),g.destination.addClass("active").siblings().removeClass("active"),g.sectionsToMove=(a=g,"down"===a.yMovement?e(".pp-section").map(function(n){if(n<a.destination.index(".pp-section"))return e(this)}):e(".pp-section").map(function(n){if(n>a.destination.index(".pp-section"))return e(this)})),"down"===g.yMovement?(g.translate3d="vertical"!==I.direction?"translate3d(-100%, 0px, 0px)":"translate3d(0px, -100%, 0px)",g.scrolling="-100%",I.css3||g.sectionsToMove.each(function(n){n!=g.activeSection.index(".pp-section")&&e(this).css(r(g.scrolling))}),g.animateSection=g.activeSection):(g.translate3d="translate3d(0px, 0px, 0px)",g.scrolling="0",g.animateSection=n),e.isFunction(I.onLeave)&&I.onLeave.call(this,g.leavingSection,g.sectionIndex+1,g.yMovement),p=g,I.css3?(d(p.animateSection,p.translate3d,p.animated),p.sectionsToMove.each(function(){d(e(this),p.translate3d,p.animated)}),setTimeout(function(){s(p)},I.scrollingSpeed)):(p.scrollOptions=r(p.scrolling),p.animated?p.animateSection.animate(p.scrollOptions,I.scrollingSpeed,I.easing,function(){c(p),s(p)}):(p.animateSection.css(r(p.scrolling)),setTimeout(function(){c(p),s(p)},400))),v=g.anchorLink,I.menu&&(e(I.menu).find(".active").removeClass("active"),e(I.menu).find('[data-menuanchor="'+v+'"]').addClass("active")),h=g.anchorLink,u=g.sectionIndex,I.navigation&&(e("#pp-nav").find(".active").removeClass("active"),h?e("#pp-nav").find('a[href="#'+h+'"]').addClass("active"):e("#pp-nav").find("li").eq(u).find("a").addClass("active")),b=g.anchorLink,y=(new Date).getTime()}}function s(n){e.isFunction(I.afterLoad)&&I.afterLoad.call(this,n.anchorLink,n.sectionIndex+1)}function c(n){"up"===n.yMovement&&n.sectionsToMove.each(function(t){e(this).css(r(n.scrolling))})}function r(e){return"vertical"===I.direction?{top:e}:{left:e}}function l(n){n=n.replace("#",""),e("body")[0].className=e("body")[0].className.replace(/\b\s?pp-viewing-[^\s]+\b/g,""),e("body").addClass("pp-viewing-"+n)}function p(){return(new Date).getTime()-y<D+I.scrollingSpeed}function d(e,n,t){var o;e.toggleClass("pp-easing",t),e.css({"-webkit-transform":o=n,"-moz-transform":o,"-ms-transform":o,transform:o})}function v(n){var o=(new Date).getTime(),i=(n=n||t.event).wheelDelta||-n.deltaY||-n.detail,a=Math.max(-1,Math.min(1,i)),s=void 0!==n.wheelDeltaX||void 0!==n.deltaX,c=Math.abs(n.wheelDeltaX)<Math.abs(n.wheelDelta)||Math.abs(n.deltaX)<Math.abs(n.deltaY)||!s;L.length>149&&L.shift(),L.push(Math.abs(i));var r=o-P;if(P=o,r>200&&(L=[]),!p()){var l=e(".pp-section.active"),d=f(l),v=h(L,10),m=h(L,70);return v>=m&&c&&(a<0?u("down",d):a>0&&u("up",d)),!1}}function h(e,n){for(var t=0,o=e.slice(Math.max(e.length-n,1)),i=0;i<o.length;i++)t+=o[i];return Math.ceil(t/n)}function u(e,n){var t,o,i,a;if("down"==e?(t="bottom",o=x.moveSectionDown):(t="top",o=x.moveSectionUp),n.length>0){if(i=t,a=n,"top"===i?!!a.scrollTop():"bottom"!==i||!(a.scrollTop()+1+a.innerHeight()>=a[0].scrollHeight))return!0;o()}else o()}function f(e){return e.filter(".pp-scrollable")}function m(){return t.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup"}:{down:"MSPointerDown",move:"MSPointerMove",up:"MSPointerUp"}}function g(e){var n=[];return n.y=void 0!==e.pageY&&(e.pageY||e.pageX)?e.pageY:e.touches[0].pageY,n.x=void 0!==e.pageX&&(e.pageY||e.pageX)?e.pageX:e.touches[0].pageX,n}function $(e){return void 0===e.pointerType||"mouse"!=e.pointerType}function S(e){var n=e.originalEvent;if($(n)){var t=g(n);C=t.y,E=t.x}}function w(n){var t=n.originalEvent;if(!function n(t,o){o=o||0;var i=e(t).parent();return!!(o<I.normalScrollElementTouchThreshold&&i.is(I.normalScrollElements))||o!=I.normalScrollElementTouchThreshold&&n(i,++o)}(n.target)&&$(t)){var o=e(".pp-section.active"),i=f(o);if(i.length||n.preventDefault(),!p()){var a=g(t);M=a.y,k=a.x,"horizontal"===I.direction&&Math.abs(E-k)>Math.abs(C-M)?Math.abs(E-k)>_.width()/100*I.touchSensitivity&&(E>k?u("down",i):k>E&&u("up",i)):Math.abs(C-M)>_.height()/100*I.touchSensitivity&&(C>M?u("down",i):M>C&&u("up",i))}}}var b,x=e.fn.pagepiling,_=e(this),y=0,T="ontouchstart"in t||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints,C=0,E=0,M=0,k=0,L=[],D=600,I=e.extend(!0,{direction:"vertical",menu:null,verticalCentered:!0,sectionsColor:[],anchors:[],scrollingSpeed:700,easing:"easeInQuart",loopBottom:!1,loopTop:!1,css3:!0,navigation:{textColor:"#000",bulletsColor:"#000",position:"right",tooltips:[]},normalScrollElements:null,normalScrollElementTouchThreshold:5,touchSensitivity:5,keyboardScrolling:!0,sectionSelector:".section",animateAnchor:!1,afterLoad:null,onLeave:null,afterRender:null},i);e.extend(e.easing,{easeInQuart:function(e,n,t,o,i){return o*(n/=i)*n*n*n+t}}),x.setScrollingSpeed=function(e){I.scrollingSpeed=e},x.setMouseWheelScrolling=function(e){e?_.get(0).addEventListener?(_.get(0).addEventListener("mousewheel",v,!1),_.get(0).addEventListener("wheel",v,!1)):_.get(0).attachEvent("onmousewheel",v):_.get(0).addEventListener?(_.get(0).removeEventListener("mousewheel",v,!1),_.get(0).removeEventListener("wheel",v,!1)):_.get(0).detachEvent("onmousewheel",v)},x.setAllowScrolling=function(e){e?(x.setMouseWheelScrolling(!0),function e(){if(T){var n=m();_.off("touchstart "+n.down).on("touchstart "+n.down,S),_.off("touchmove "+n.move).on("touchmove "+n.move,w)}}()):(x.setMouseWheelScrolling(!1),function e(){if(T){var n=m();_.off("touchstart "+n.down),_.off("touchmove "+n.move)}}())},x.setKeyboardScrolling=function(e){I.keyboardScrolling=e},x.moveSectionUp=function(){var n=e(".pp-section.active").prev(".pp-section");!n.length&&I.loopTop&&(n=e(".pp-section").last()),n.length&&a(n)},x.moveSectionDown=function(){var n=e(".pp-section.active").next(".pp-section");!n.length&&I.loopBottom&&(n=e(".pp-section").first()),n.length&&a(n)},x.moveTo=function(t){var o="";(o=isNaN(t)?e(n).find('[data-anchor="'+t+'"]'):e(".pp-section").eq(t-1)).length>0&&a(o)},e(I.sectionSelector).each(function(){e(this).addClass("pp-section")}),I.css3&&(I.css3=function e(){var i,a=n.createElement("p"),s={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var c in n.body.insertBefore(a,null),s)a.style[c]!==o&&(a.style[c]="translate3d(1px,1px,1px)",i=t.getComputedStyle(a).getPropertyValue(s[c]));return n.body.removeChild(a),i!==o&&i.length>0&&"none"!==i}()),e(_).css({overflow:"hidden","-ms-touch-action":"none","touch-action":"none"}),x.setAllowScrolling(!0),e.isEmptyObject(I.navigation)||function n(){e("body").append('<div id="pp-nav"><ul></ul></div>');var t=e("#pp-nav");t.css("color",I.navigation.textColor),t.addClass(I.navigation.position);for(var o=0;o<e(".pp-section").length;o++){var i="";if(I.anchors.length&&(i=I.anchors[o]),"undefined"!==I.navigation.tooltips){var a=I.navigation.tooltips[o];void 0===a&&(a="")}t.find("ul").append('<li data-tooltip="'+a+'"><a href="#'+i+'"><span></span></a></li>')}t.find("span").css("border-color",I.navigation.bulletsColor)}();var X=e(".pp-section").length;e(".pp-section").each(function(n){e(this).data("data-index",n),e(this).css("z-index",X),n||0!==e(".pp-section.active").length||e(this).addClass("active"),void 0!==I.anchors[n]&&e(this).attr("data-anchor",I.anchors[n]),void 0!==I.sectionsColor[n]&&e(this).css("background-color",I.sectionsColor[n]),I.verticalCentered&&!e(this).hasClass("pp-scrollable")&&function e(n){n.addClass("pp-table").wrapInner('<div class="pp-tableCell" style="height:100%" />')}(e(this)),X-=1}).promise().done(function(){I.navigation&&(e("#pp-nav").css("margin-top","-"+e("#pp-nav").height()/2+"px"),e("#pp-nav").find("li").eq(e(".pp-section.active").index(".pp-section")).find("a").addClass("active")),e(t).on("load",function(){var o,i;o=t.location.hash.replace("#",""),(i=e(n).find('.pp-section[data-anchor="'+o+'"]')).length>0&&a(i,I.animateAnchor)}),e.isFunction(I.afterRender)&&I.afterRender.call(this)}),e(t).on("hashchange",function o(){var i,s=t.location.hash.replace("#","").split("/")[0];s.length&&s&&s!==b&&a(i=isNaN(s)?e(n).find('[data-anchor="'+s+'"]'):e(".pp-section").eq(s-1))}),e(n).keydown(function(n){if(I.keyboardScrolling&&!p())switch(n.which){case 38:case 33:case 37:x.moveSectionUp();break;case 40:case 34:case 39:x.moveSectionDown();break;case 36:x.moveTo(1);break;case 35:x.moveTo(e(".pp-section").length);break;default:return}}),I.normalScrollElements&&(e(n).on("mouseenter",I.normalScrollElements,function(){x.setMouseWheelScrolling(!1)}),e(n).on("mouseleave",I.normalScrollElements,function(){x.setMouseWheelScrolling(!0)}));var P=(new Date).getTime();e(n).on("click touchstart","#pp-nav a",function(n){n.preventDefault();var t=e(this).parent().index();a(e(".pp-section").eq(t))}),e(n).on({mouseenter:function(){var n=e(this).data("tooltip");e('<div class="pp-tooltip '+I.navigation.position+'">'+n+"</div>").hide().appendTo(e(this)).fadeIn(200)},mouseleave:function(){e(this).find(".pp-tooltip").fadeOut(200,function(){e(this).remove()})}},"#pp-nav li")}}(jQuery,document,window);